<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëœë¤ ë¼ì´ì–´ ê²Œì„</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 30px; background-color: #f4f4f4; }
        #login-container, #game-container { background: white; padding: 20px; border-radius: 10px; display: inline-block; }
        button { padding: 10px; font-size: 16px; margin-top: 10px; cursor: pointer; }
        #chat-box { width: 100%; height: 200px; overflow-y: scroll; border: 1px solid #ddd; padding: 10px; text-align: left; }
        input { width: 80%; padding: 10px; }
        #timer { font-size: 20px; font-weight: bold; color: red; }
    </style>
</head>
<body>

    <!-- ë¡œê·¸ì¸ í™”ë©´ -->
    <div id="login-container">
        <h1>ë¼ì´ì–´ ê²Œì„</h1>
        <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„ ì…ë ¥" />
        <button onclick="login()">ê²Œì„ ì°¸ê°€</button>
    </div>

    <!-- ê²Œì„ í™”ë©´ (ë¡œê·¸ì¸ í›„ í‘œì‹œë¨) -->
    <div id="game-container" style="display: none;">
        <h2>ì£¼ì œì–´: <span id="main-word">???</span></h2>
        <h3>ë‹¹ì‹ ì˜ ë‹¨ì–´: <span id="sub-word">???</span></h3>
        <p>í˜„ì¬ í„´: <span id="current-turn">---</span></p>
        <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
    </div>

    <h2>ì±„íŒ…</h2>
    <div id="chat-box"></div>
    <input type="text" id="chat-input" placeholder="ë©”ì‹œì§€ ì…ë ¥..." disabled />
    <button onclick="sendMessage()" id="send-btn" disabled>ì „ì†¡</button>

    <h2>íƒ€ì´ë¨¸: <span id="timer">60</span>ì´ˆ</h2>
    <button onclick="votePhase()" id="vote-btn" disabled>íˆ¬í‘œ ì‹œì‘</button>

    <script>
        // ğŸ”¥ Firebase ì„¤ì • (ë³¸ì¸ì˜ Firebase ì„¤ì •ê°’ìœ¼ë¡œ ë³€ê²½!)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let playerId = "";
        let playerNickname = "";
        let isLiar = false;
        let playerList = [];
        let turnIndex = 0;
        let timerInterval;

        function login() {
            playerNickname = document.getElementById("nickname").value.trim();
            if (playerNickname === "") {
                alert("ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”!");
                return;
            }

            playerId = Math.random().toString(36).substr(2, 6); // ëœë¤ í”Œë ˆì´ì–´ ID
            db.ref("players/" + playerId).set({ id: playerId, nickname: playerNickname });

            document.getElementById("login-container").style.display = "none";
            document.getElementById("game-container").style.display = "block";

            db.ref("players").once("value", (snapshot) => {
                playerList = Object.keys(snapshot.val());
                if (playerList.length === 1) {
                    startGame();
                }
            });
        }

        function startGame() {
            constwordData = { "ê³¼ì¼": ["ì‚¬ê³¼", "ë°”ë‚˜ë‚˜", "í¬ë„", "ìˆ˜ë°•", "ê·¤", "ë³µìˆ­ì•„", "ì²´ë¦¬", "íŒŒì¸ì• í”Œ", "ë§ê³ ", "ìë‘"], "ì±„ì†Œ": ["ë‹¹ê·¼", "ì–‘íŒŒ", "ê°ì", "ê³ êµ¬ë§ˆ", "ìƒì¶”", "ë¸Œë¡œì½œë¦¬", "ì˜¤ì´", "ë°°ì¶”", "ë¬´", "íŒŒí”„ë¦¬ì¹´"], "ìŒì‹": ["ê¹€ì¹˜", "ë–¡ë³¶ì´", "í”¼ì", "í–„ë²„ê±°", "ì§œì¥ë©´", "íŒŒìŠ¤íƒ€", "ë¶ˆê³ ê¸°", "ì´ˆë°¥", "ìƒŒë“œìœ„ì¹˜", "ë¼ë©´"], "ë™ë¬¼": ["ê°•ì•„ì§€", "ê³ ì–‘ì´", "í† ë¼", "í˜¸ë‘ì´", "ì‚¬ì", "ì½”ë¼ë¦¬", "ê¸°ë¦°", "íŒë‹¤", "í­ê·„", "ìˆ˜ë‹¬"], "íƒˆê²ƒ": ["ìë™ì°¨", "ë¹„í–‰ê¸°", "ê¸°ì°¨", "ìì „ê±°", "ë²„ìŠ¤", "íŠ¸ëŸ­", "ì˜¤í† ë°”ì´", "ìš”íŠ¸", "ë°°", "íŠ¸ë¨"], "ì§ì—…": ["ì˜ì‚¬", "ê²½ì°°", "ì†Œë°©ê´€", "ì„ ìƒë‹˜", "ë°°ìš°", "ê°€ìˆ˜", "ìš´ë™ì„ ìˆ˜", "í”„ë¡œê·¸ë˜ë¨¸", "ìš”ë¦¬ì‚¬", "íŒŒì¼ëŸ¿"], "ë„êµ¬": ["ë§ì¹˜", "ë“œë¼ì´ë²„", "ê°€ìœ„", "ë¶“", "ì¹¼", "ë Œì¹˜", "ë„ë¼", "í†±", "ì†¡ê³³", "ì"], "ì¥ì†Œ": ["í•™êµ", "ë³‘ì›", "ê³µì›", "ë„ì„œê´€", "ì˜í™”ê´€", "ë†€ì´ê³µì›", "ì¹´í˜", "ì‹ë‹¹", "ê²½ì°°ì„œ", "í•´ë³€"], "ìŠ¤í¬ì¸ ": ["ì¶•êµ¬", "ì•¼êµ¬", "ë†êµ¬", "ë°°êµ¬", "í…Œë‹ˆìŠ¤", "ê³¨í”„", "íƒœê¶Œë„", "ë³µì‹±", "ìˆ˜ì˜", "ìŠ¤í‚¤"], "ì•…ê¸°": ["í”¼ì•„ë…¸", "ê¸°íƒ€", "ë“œëŸ¼", "ë°”ì´ì˜¬ë¦°", "íŠ¸ëŸ¼í«", "í”Œë£¨íŠ¸", "ì²¼ë¡œ", "í´ë¼ë¦¬ë„·", "í•˜ëª¨ë‹ˆì¹´", "ìƒ‰ì†Œí°"], "ì „ìê¸°ê¸°": ["ìŠ¤ë§ˆíŠ¸í°", "ë…¸íŠ¸ë¶", "íƒœë¸”ë¦¿", "ìŠ¤ë§ˆíŠ¸ì›Œì¹˜", "í…”ë ˆë¹„ì „", "ì¹´ë©”ë¼", "ê²Œì„ê¸°", "í‚¤ë³´ë“œ", "ë§ˆìš°ìŠ¤", "í”„ë¦°í„°"] };

            const mainWords = Object.keys(wordData);
            const randomMain = mainWords[Math.floor(Math.random() * mainWords.length)];
            const subWords = wordData[randomMain];
            const randomSub = subWords[Math.floor(Math.random() * subWords.length)];

            db.ref("game").set({
                mainWord: randomMain,
                subWord: randomSub,
                liar: playerList[Math.floor(Math.random() * playerList.length)]
            });

            assignWord({ mainWord: randomMain, subWord: randomSub, liar: playerId });
        }

        function assignWord(gameData) {
            document.getElementById("main-word").textContent = gameData.mainWord;
            if (gameData.liar === playerId) {
                document.getElementById("sub-word").textContent = "??? (ë‹¹ì‹ ì€ ë¼ì´ì–´ì…ë‹ˆë‹¤!)";
                isLiar = true;
            } else {
                document.getElementById("sub-word").textContent = gameData.subWord;
            }
        }

        function startTurn() {
            db.ref("turn").set(playerList[turnIndex]);
        }

        db.ref("turn").on("value", (snapshot) => {
            if (snapshot.exists()) {
                let currentTurn = snapshot.val();
                document.getElementById("current-turn").textContent = currentTurn;
                document.getElementById("chat-input").disabled = !(currentTurn === playerId);
                document.getElementById("send-btn").disabled = !(currentTurn === playerId);
            }
        });

        function sendMessage() {
            const message = document.getElementById("chat-input").value;
            if (message.trim() !== "") {
                db.ref("chat").push({ player: playerNickname, text: message });
                document.getElementById("chat-input").value = "";
                turnIndex = (turnIndex + 1) % playerList.length;
                startTurn();
            }
        }

        function votePhase() {
            document.getElementById("vote-btn").disabled = true;
            startTimer(15, "íˆ¬í‘œ ì‹œê°„");
        }

        function startTimer(seconds, message) {
            let timeLeft = seconds;
            document.getElementById("timer").textContent = timeLeft;

            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById("timer").textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert(message + " ì¢…ë£Œ!");
                }
            }, 1000);
        }

        db.ref("chat").on("child_added", (snapshot) => {
            const message = snapshot.val();
            const chatBox = document.getElementById("chat-box");
            chatBox.innerHTML += `<p><strong>${message.player}:</strong> ${message.text}</p>`;
            chatBox.scrollTop = chatBox.scrollHeight;
        });

    </script>

</body>
</html>
